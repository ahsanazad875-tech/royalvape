<div class="card shadow-sm">
  <div class="card-body">
    <div class="d-flex align-items-center mb-3">
      <button
        abpPermission="POS.Branches.Create"
        class="btn btn-primary me-auto"
        [routerLink]="['/branches/edit']">
        <i class="fa fa-plus me-1"></i> Create Branch
      </button>

      <div class="d-flex align-items-center gap-2">
        <span class="text-muted small">
          Total: <strong>{{ total }}</strong>
        </span>

        <button
          class="btn btn-outline-secondary btn-sm"
          (click)="refresh()"
          [disabled]="loading"
          title="Refresh">
          <i class="fa fa-rotate"></i>
        </button>
      </div>
    </div>

    <nz-table
      [nzData]="rows"
      [nzLoading]="loading"
      [nzFrontPagination]="false"
      [nzTotal]="total"
      [nzPageIndex]="pageIndex"
      [nzPageSize]="pageSize"
      [nzShowSizeChanger]="true"
      [nzPageSizeOptions]="[10, 20, 50, 100]"
      nzTableLayout="fixed"
      [nzScroll]="{ x: '900px' }"
      (nzQueryParams)="onQueryParamsChange($event)"
      [nzNoResult]="noResultTpl">

      <thead>
        <tr>
          <th
            nzWidth="140px"
            nzColumnKey="{{ SORT.Code }}"
            [nzSortFn]="true"
            [nzSortOrder]="sortOrder(SORT.Code)"
            class="text-uppercase small fw-semibold text-muted">
            Code
          </th>

          <th
            nzWidth="320px"
            nzColumnKey="{{ SORT.Name }}"
            [nzSortFn]="true"
            [nzSortOrder]="sortOrder(SORT.Name)"
            class="text-uppercase small fw-semibold text-muted">
            Name
          </th>

          <th
            nzWidth="120px"
            nzColumnKey="{{ SORT.VatPerc }}"
            [nzSortFn]="true"
            [nzSortOrder]="sortOrder(SORT.VatPerc)"
            class="text-uppercase small fw-semibold text-muted text-end">
            VAT %
          </th>

          <th
            nzWidth="140px"
            nzColumnKey="{{ SORT.IsActive }}"
            [nzSortFn]="true"
            [nzSortOrder]="sortOrder(SORT.IsActive)"
            class="text-uppercase small fw-semibold text-muted">
            Status
          </th>

          <th nzWidth="140px" class="text-end"></th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let b of rows; trackBy: trackById">
          <td class="text-muted">{{ b.code }}</td>

          <td class="fw-semibold cell-ellipsis" [title]="b.name">
            {{ b.name }}
          </td>

          <td class="text-end">
            <span class="badge rounded-pill bg-secondary text-dark px-3">
              {{ b.vatPerc | number:'1.0-2' }}%
            </span>
          </td>

          <td>
            <span
              class="badge rounded-pill px-3"
              [class.bg-success]="b.isActive"
              [class.text-light]="b.isActive"
              [class.bg-secondary]="!b.isActive">
              {{ b.isActive ? 'Active' : 'Inactive' }}
            </span>
          </td>

          <td class="text-end">
            <a
              [routerLink]="['/branches/edit', b.id]"
              abpPermission="POS.Branches.Edit"
              class="btn btn-outline-secondary btn-xs">
              <i class="fa fa-edit me-1"></i> Edit
            </a>
          </td>
        </tr>
      </tbody>
    </nz-table>

    <ng-template #noResultTpl>
      <div class="text-center text-muted py-4">
        No branches found.
      </div>
    </ng-template>
  </div>
</div>